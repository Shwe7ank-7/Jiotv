<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shwe7ank - Jiotv</title>
<style>
  :root { --bg-primary: #0f172a; --bg-secondary: #1e293b; --text-primary: #f8fafc; --accent: #3b82f6; }
  body { margin: 0; font-family: sans-serif; background: var(--bg-primary); color: var(--text-primary); }
  
  /* Header & Search */
  header { position: sticky; top: 0; z-index: 100; background: var(--bg-secondary); padding: 15px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
  .logo { font-weight: 900; letter-spacing: 1px; color: #fff; }
  
  .search-box { padding: 10px; background: var(--bg-primary); }
  input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #334155; background: var(--bg-secondary); color: white; box-sizing: border-box; }

  /* Grid */
  #grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; padding: 10px; }
  .card { background: var(--bg-secondary); border-radius: 10px; overflow: hidden; cursor: pointer; transition: 0.2s; position: relative; }
  .card:active { transform: scale(0.95); }
  .card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; background: #000; }
  .card-title { padding: 8px; font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-align: center; }
  
  /* Category Tags */
  .tag { position: absolute; top: 0; right: 0; background: var(--accent); font-size: 10px; padding: 2px 6px; border-bottom-left-radius: 6px; }
</style>
</head>
<body>

<header>
  <div class="logo">MOMIXTV+</div>
  <div style="font-size: 12px; color: #aaa;">LIVE</div>
</header>

<div class="search-box">
  <input type="text" id="search" placeholder="Search 500+ Channels..." oninput="render()">
</div>

<div id="grid"></div>

<script>
// --- CONFIGURATION ---
const M3U_URL = "https://raw.githubusercontent.com/alex8875/m3u/refs/heads/main/jstar.m3u";

let allChannels = [];

window.onload = async () => {
  try {
    const res = await fetch(M3U_URL);
    const text = await res.text();
    parseM3U(text);
  } catch (e) {
    document.getElementById('grid').innerHTML = "Failed to load channels. Check internet.";
  }
};

function parseM3U(data) {
  const lines = data.split('\n');
  let currentChannel = {};
  
  lines.forEach(line => {
    line = line.trim();
    if (line.startsWith('#EXTINF:')) {
      const logoMatch = line.match(/tvg-logo="([^"]*)"/);
      const groupMatch = line.match(/group-title="([^"]*)"/);
      const nameParts = line.split(',');
      const name = nameParts[nameParts.length - 1].trim();
      
      currentChannel = {
        name: name || "Unknown Channel",
        logo: (logoMatch && logoMatch[1]) ? logoMatch[1] : "https://via.placeholder.com/150?text=TV",
        category: (groupMatch && groupMatch[1]) ? groupMatch[1] : "Other"
      };
    } else if (line.startsWith('http')) {
      currentChannel.url = line;
      allChannels.push(currentChannel);
    }
  });
  render();
}

function render() {
  const grid = document.getElementById('grid');
  const query = document.getElementById('search').value.toLowerCase();
  
  grid.innerHTML = "";
  
  // FILTER: Only show matching names
  const filtered = allChannels.filter(c => c.name.toLowerCase().includes(query));

  filtered.slice(0, 300).forEach(c => { // Limit to 300 for speed
    const d = document.createElement('div');
    d.className = 'card';
    d.onclick = () => window.location.href = `watch.html?play=${encodeURIComponent(c.url)}`;
    d.innerHTML = `
      <div class="tag">${c.category}</div>
      <img src="${c.logo}" loading="lazy">
      <div class="card-title">${c.name}</div>
    `;
    grid.appendChild(d);
  });
}
</script>
</body>
</html>
